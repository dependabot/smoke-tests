command: graph
input:
    job:
        command: graph
        package-manager: go_modules
        allowed-updates:
            - update-type: all
        experiments:
            enable_dependency_submission_poc: true
        source:
            provider: github
            repo: dependabot/smoke-tests
            directories:
                - go
            commit: adefdc01a3f0b0b041832dcf906c1d52fdfa08ec
            hostname: github.com
            api-endpoint: https://api.github.com
    credentials:
        - host: github.com
          password: $LOCAL_GITHUB_ACCESS_TOKEN
          type: git_source
          username: x-access-token
output:
    - type: create_dependency_submission
      expect:
        data:
            version: 0
            sha: adefdc01a3f0b0b041832dcf906c1d52fdfa08ec
            ref: refs/heads/main
            job:
                correlator: dependabot-go_modules-go
                id: cli
            detector:
                name: dependabot
                url: https://github.com/dependabot/dependabot-core
                version: 0.345.0
            manifests:
                /go/go.mod:
                    file:
                        source_location: go/go.mod
                    metadata:
                        ecosystem: go_modules
                    name: /go/go.mod
                    resolved:
                        github.com/fatih/color:
                            dependencies: []
                            package_url: pkg:golang/github.com/fatih/color@v1.7.0
                            relationship: direct
                            scope: runtime
                        github.com/inconshreveable/mousetrap:
                            dependencies: []
                            package_url: pkg:golang/github.com/inconshreveable/mousetrap@v0.0.0-20141017200713-76626ae9c91c
                            relationship: direct
                            scope: runtime
                        github.com/mattn/go-colorable:
                            dependencies: []
                            package_url: pkg:golang/github.com/mattn/go-colorable@v0.0.9
                            relationship: indirect
                            scope: runtime
                        github.com/mattn/go-isatty:
                            dependencies: []
                            package_url: pkg:golang/github.com/mattn/go-isatty@v0.0.4
                            relationship: indirect
                            scope: runtime
                        golang.org/x/crypto:
                            dependencies: []
                            package_url: pkg:golang/golang.org/x/crypto@v0.0.0-20180617042118-027cca12c2d6
                            relationship: direct
                            scope: runtime
                        golang.org/x/sys:
                            dependencies:
                                - go
                            package_url: pkg:golang/golang.org/x/sys@v0.37.0
                            relationship: indirect
                            scope: runtime
                        golang.org/x/text:
                            dependencies:
                                - golang.org/x/tools
                            package_url: pkg:golang/golang.org/x/text@v0.3.7
                            relationship: indirect
                            scope: runtime
                        rsc.io/quote:
                            dependencies:
                                - rsc.io/sampler
                            package_url: pkg:golang/rsc.io/quote@v1.4.0
                            relationship: direct
                            scope: runtime
                        rsc.io/sampler:
                            dependencies: []
                            package_url: pkg:golang/rsc.io/sampler@v1.0.0
                            relationship: indirect
                            scope: runtime
    - type: mark_as_processed
      expect:
        data:
            base-commit-sha: adefdc01a3f0b0b041832dcf906c1d52fdfa08ec
