input:
    job:
        command: update
        package-manager: docker
        allowed-updates:
            - update-type: all
        ignore-conditions:
            - dependency-name: regclient/regctl
              source: tests/smoke-docker-metadata-only-digest.yaml
              version-requirement: '>a734f285c0962e46557bff24489fa0b0521455733f72d9eb30c4f7a5027aeed6'
        source:
            provider: github
            repo: dependabot/smoke-tests
            directories:
                - docker/metadata/only-digest
            commit: f264dace05b256e661f62c8bc9580659c1ffb591
            hostname: github.com
            api-endpoint: https://api.github.com
    credentials:
        - host: github.com
          password: $LOCAL_GITHUB_ACCESS_TOKEN
          type: git_source
          username: x-access-token
output:
    - type: update_dependency_list
      expect:
        data:
            dependencies:
                - name: regclient/regctl
                  requirements:
                    - file: Dockerfile
                      groups: []
                      requirement: null
                      source:
                        digest: 85c2b62eef4c196736b9303c899755dc23c45775fb5fbcf5378535cf7000e078
                  version: 85c2b62eef4c196736b9303c899755dc23c45775fb5fbcf5378535cf7000e078
            dependency_files:
                - /docker/metadata/only-digest/Dockerfile
    - type: create_pull_request
      expect:
        data:
            base-commit-sha: f264dace05b256e661f62c8bc9580659c1ffb591
            dependencies:
                - name: regclient/regctl
                  previous-requirements:
                    - file: Dockerfile
                      groups: []
                      requirement: null
                      source:
                        digest: 85c2b62eef4c196736b9303c899755dc23c45775fb5fbcf5378535cf7000e078
                  previous-version: 85c2b62eef4c196736b9303c899755dc23c45775fb5fbcf5378535cf7000e078
                  requirements:
                    - file: Dockerfile
                      groups: []
                      requirement: null
                      source:
                        digest: a734f285c0962e46557bff24489fa0b0521455733f72d9eb30c4f7a5027aeed6
                  version: a734f285c0962e46557bff24489fa0b0521455733f72d9eb30c4f7a5027aeed6
                  directory: /docker/metadata/only-digest
            updated-dependency-files:
                - content: FROM regclient/regctl@sha256:a734f285c0962e46557bff24489fa0b0521455733f72d9eb30c4f7a5027aeed6
                  content_encoding: utf-8
                  deleted: false
                  directory: /docker/metadata/only-digest
                  name: Dockerfile
                  operation: update
                  support_file: false
                  type: file
            pr-title: Bump regclient/regctl from `85c2b62` to `a734f28` in /docker/metadata/only-digest
            pr-body: |
                Bumps regclient/regctl from `85c2b62` to `a734f28`.
            commit-message: |-
                Bump regclient/regctl in /docker/metadata/only-digest

                Bumps regclient/regctl from `85c2b62` to `a734f28`.
    - type: mark_as_processed
      expect:
        data:
            base-commit-sha: f264dace05b256e661f62c8bc9580659c1ffb591
